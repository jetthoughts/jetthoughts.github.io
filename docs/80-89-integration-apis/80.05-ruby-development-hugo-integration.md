# Ruby Development Integration with Hugo/Jekyll Workflows

**Project-specific adaptation of global Ruby standards for JT Site Hugo/Jekyll testing integration**

## 📚 Overview

This document defines Ruby development patterns specifically for the JT Site project, extending global Ruby standards to work seamlessly with Hugo static site generation and Jekyll compatibility patterns.

**Extends Global References**:
- **`/knowledge/80.01-ruby-development-standards.md`** - Core Ruby development standards
- **`/knowledge/80.02-rails-framework-guidelines.md`** - Rails framework guidelines
- **`/knowledge/80.03-ruby-testing-methodology.md`** - Ruby TDD methodology

**Project Scope**: Hugo static site with Ruby test automation
**Focus**: Test-driven content validation, automated quality assurance, and Jekyll compatibility

## 🏗️ Architecture Integration

### Hugo + Ruby Test Architecture
```yaml
jt_site_ruby_integration:
  primary_purpose: "Automated testing of Hugo-generated static content"
  ruby_version: "3.3.0"
  test_framework: "minitest"
  integration_points:
    - "Hugo build validation through Ruby tests"
    - "Content quality assurance automation"
    - "Jekyll compatibility testing"
    - "Static site SEO validation"
    - "Performance benchmarking"

  hugo_integration_patterns:
    build_validation: "Ruby tests validate Hugo build output"
    content_testing: "Ruby automation tests markdown content and frontmatter"
    seo_compliance: "Ruby scripts validate meta tags and structured data"
    performance_testing: "Ruby benchmarks for Hugo build times and optimization"
```

### Directory Structure Integration
```bash
# Hugo + Ruby integrated structure
├── test/                        # Ruby test directory (existing)
│   ├── unit/                    # Unit tests for Ruby modules
│   │   ├── hugo_asset_validation_test.rb
│   │   ├── meta_tags/           # SEO and schema tests
│   │   └── sync/                # Content sync automation tests
│   ├── integration/             # Integration tests
│   └── system/                  # Full-system validation
├── lib/                         # Ruby libraries for Hugo integration
├── Gemfile                      # Ruby dependencies (existing)
├── Rakefile                     # Ruby task automation (existing)
└── bin/                         # Integrated build scripts
    ├── test                     # Calls both Hugo and Ruby tests
    └── ruby-test                # Ruby-specific test runner
```

## 💎 Ruby Code Standards for Hugo Integration

### Hugo-Specific Ruby Patterns
```ruby
# frozen_string_literal: true

# Hugo content validation module
module HugoValidation
  # Test Hugo build output for content integrity
  def self.validate_build_output(build_path)
    Dir.glob("#{build_path}/**/*.html").each do |html_file|
      content = File.read(html_file)
      validate_html_structure(content, html_file)
      validate_meta_tags(content, html_file)
    end
  end

  private

    def self.validate_html_structure(content, file_path)
      # Hugo-specific HTML structure validation
      assert content.include?("<html"), "Missing HTML structure in #{file_path}"
      assert content.include?("</html>"), "Unclosed HTML structure in #{file_path}"
    end

    def self.validate_meta_tags(content, file_path)
      # SEO meta tag validation
      required_meta = ["<title>", "<meta name=\"description\""]
      required_meta.each do |tag|
        assert content.include?(tag), "Missing #{tag} in #{file_path}"
      end
    end
end

# Jekyll compatibility testing
module JekyllCompatibility
  def self.test_frontmatter_compatibility(markdown_file)
    content = File.read(markdown_file)
    frontmatter = extract_frontmatter(content)

    # Test Jekyll frontmatter patterns
    assert frontmatter.key?("title"), "Missing title in #{markdown_file}"
    assert frontmatter.key?("date"), "Missing date in #{markdown_file}"
  end

  private

    def self.extract_frontmatter(content)
      match = content.match(/\A---\n(.*?)\n---/m)
      return {} unless match

      YAML.safe_load(match[1]) || {}
    end
end
```

### Minitest Integration for Hugo
```ruby
# frozen_string_literal: true

require "minitest/autorun"
require_relative "../lib/hugo_validation"

class HugoBuildTest < Minitest::Test
  def setup
    @build_path = "public"
    @content_path = "content"
  end

  def test_hugo_build_generates_valid_html
    # Test Hugo build produces valid HTML
    html_files = Dir.glob("#{@build_path}/**/*.html")
    refute_empty html_files, "Hugo build should generate HTML files"

    html_files.each do |file|
      content = File.read(file)
      assert content.include?("<html"), "#{file} should contain valid HTML structure"
      assert content.include?("</html>"), "#{file} should have closed HTML structure"
    end
  end

  def test_content_meta_tags_present
    # Test all pages have required SEO meta tags
    html_files = Dir.glob("#{@build_path}/**/*.html")

    html_files.each do |file|
      content = File.read(file)
      assert content.include?("<title>"), "#{file} missing title tag"
      assert content.include?('<meta name="description"'), "#{file} missing description meta tag"
    end
  end

  def test_jekyll_frontmatter_compatibility
    # Test markdown files use Jekyll-compatible frontmatter
    markdown_files = Dir.glob("#{@content_path}/**/*.md")

    markdown_files.each do |file|
      content = File.read(file)
      assert content.start_with?("---\n"), "#{file} should start with frontmatter"

      # Validate YAML frontmatter
      frontmatter_match = content.match(/\A---\n(.*?)\n---/m)
      assert frontmatter_match, "#{file} should have valid frontmatter block"

      frontmatter = YAML.safe_load(frontmatter_match[1])
      assert frontmatter["title"], "#{file} frontmatter missing title"
    end
  end
end
```

## 🧪 TDD Integration with Hugo Workflow

### Ruby TDD for Static Site Development
```yaml
hugo_ruby_tdd_workflow:
  red_phase: "Write failing test for Hugo feature (content validation, SEO, etc.)"
  green_phase: "Implement minimal Ruby automation to make test pass"
  refactor_phase: "Optimize Ruby code for performance and Hugo integration"

  hugo_specific_tests:
    content_validation: "Test markdown content matches Hugo requirements"
    build_validation: "Test Hugo build produces expected output"
    seo_validation: "Test generated HTML meets SEO requirements"
    performance_validation: "Test Hugo build performance meets targets"
    jekyll_compatibility: "Test content works with Jekyll patterns"
```

### Test Categories for Hugo Integration
```ruby
# Unit tests - Individual Ruby modules
class ContentValidatorTest < Minitest::Test
  def test_validates_frontmatter_structure
    # Test individual content validation methods
  end
end

# Integration tests - Hugo build integration
class HugoIntegrationTest < Minitest::Test
  def test_hugo_build_with_ruby_validation
    # Test Ruby validation works with Hugo build process
  end
end

# System tests - Full workflow validation
class StaticSiteSystemTest < Minitest::Test
  def test_complete_build_and_validation_workflow
    # Test entire Hugo + Ruby validation pipeline
  end
end
```

## 🔧 Hugo-Specific Ruby Tools

### Existing Tools Integration
```bash
# Ruby tools that integrate with Hugo workflow
bundle exec rake test        # Main Ruby test suite
bundle exec standardrb       # Ruby style compliance
bundle install              # Dependency management

# Hugo tools that work with Ruby
bin/test                     # Integrated Hugo + Ruby testing
bin/hugo-build              # Hugo build with Ruby validation
bun run test                # Complete test suite including Ruby

# Integration tools
hugo --buildDrafts           # Hugo build for Ruby testing
ruby test/integration/hugo_test.rb  # Ruby-driven Hugo validation
```

### Ruby Gem Dependencies for Hugo Integration
```ruby
# Gemfile additions for Hugo integration
gem "yaml"              # Frontmatter parsing
gem "nokogiri"          # HTML parsing and validation
gem "addressable"       # URL validation
gem "benchmark-ips"     # Performance benchmarking
gem "simplecov"         # Code coverage for Ruby tests
gem "minitest-reporters"  # Enhanced test output
```

## 👥 Four-Eyes Integration for Ruby + Hugo

### Ruby Review Requirements
```yaml
ruby_hugo_review_protocol:
  mandatory_pairing:
    primary_reviewer: "ruby-reviewer"
    secondary_reviewer: "hugo-developer OR qa-expert"
    focus_areas:
      - "Ruby code quality and idioms"
      - "Hugo integration patterns"
      - "Test coverage and quality"
      - "Performance implications"

  review_checklist:
    ruby_standards: "Follows global Ruby development standards"
    hugo_integration: "Properly integrates with Hugo build pipeline"
    test_quality: "Tests validate actual Hugo behavior"
    performance: "Ruby code doesn't slow Hugo build significantly"
    maintainability: "Code is readable and well-documented"
```

## 📋 Hugo + Ruby Development Checklist

### Pre-Development Setup
- [ ] Ruby 3.3.0 installed and configured
- [ ] Bundler dependencies installed (`bundle install`)
- [ ] Hugo development server running (`bin/hugo-dev`)
- [ ] Test suite passing (`bin/test`)
- [ ] Standard Ruby linting configured

### During Development
- [ ] Follow Ruby TDD methodology (Red-Green-Refactor)
- [ ] Test Hugo integration at each step
- [ ] Maintain Jekyll compatibility where applicable
- [ ] Run `bundle exec standardrb` for style compliance
- [ ] Monitor Hugo build performance impact

### Post-Development Validation
- [ ] All Ruby tests passing (`bundle exec rake test`)
- [ ] Hugo build successful with Ruby validation (`bin/test`)
- [ ] Zero StandardRB violations
- [ ] Performance benchmarks within acceptable ranges
- [ ] Four-eyes review completed (ruby-reviewer + hugo-developer)
- [ ] Documentation updated for new Ruby patterns

## 🚀 Deployment and Production Considerations

### Hugo + Ruby Production Pipeline
```yaml
production_pipeline:
  build_process:
    step_1: "Ruby test suite validation"
    step_2: "Hugo static site generation"
    step_3: "Ruby post-build validation"
    step_4: "Performance benchmarking"
    step_5: "SEO compliance checking"

  optimization_targets:
    ruby_execution_time: "< 5 seconds for full test suite"
    hugo_build_time: "< 30 seconds for full site"
    total_pipeline_time: "< 2 minutes including all validations"
```

### Jekyll Migration Compatibility
```yaml
jekyll_compatibility_matrix:
  supported_patterns:
    - "YAML frontmatter with Jekyll structure"
    - "Liquid template syntax (basic)"
    - "Jekyll post naming conventions"
    - "Jekyll category and tag systems"

  hugo_extensions:
    - "Hugo shortcodes (with Jekyll fallback documentation)"
    - "Hugo taxonomies (with Jekyll category mapping)"
    - "Hugo data files (with Jekyll _data compatibility)"
```

## 🔗 Integration Points

### Memory Coordination for Ruby + Hugo
```bash
# Cross-agent coordination for Ruby development
coordination/ruby-hugo/*         # Ruby and Hugo integration coordination
quality/ruby-standards/*         # Ruby code quality tracking
testing/ruby-integration/*       # Ruby test execution results
performance/ruby-benchmarks/*    # Ruby performance metrics
```

### Expert Agent Integration
```bash
# Ruby expert consultation patterns
Task("Ruby Coder", "Implement Hugo content validation in Ruby", "ruby-coder")
Task("Ruby Reviewer", "Review Ruby integration with Hugo pipeline", "ruby-reviewer")
Task("QA Expert", "Validate Ruby tests integrate properly with Hugo", "qa-expert")
Task("Architecture Expert", "Design Ruby + Hugo architecture patterns", "architecture-expert")
```

---

**Integration Summary**: This document extends global Ruby standards specifically for Hugo static site integration, focusing on test automation, content validation, and Jekyll compatibility while maintaining Ruby best practices and TDD methodology.