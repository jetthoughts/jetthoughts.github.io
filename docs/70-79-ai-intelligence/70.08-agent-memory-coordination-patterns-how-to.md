# Agent Memory Coordination Patterns for jt_site

**Document Type**: How-To Guide (Di√°taxis)
**Classification**: 70-79 AI Intelligence
**Authority**: jt_site Project Standard (extends global standards)
**Status**: Production Ready
**Last Updated**: 2025-10-15

## üéØ Purpose

This guide provides the CORRECT memory coordination patterns for jt_site agents to share work outputs and coordinate tasks. This replaces the INCORRECT `_runtime/` folder approach with proper claude-flow MCP memory tool usage.

## üö® Critical Understanding

### ‚ùå WRONG APPROACH (DO NOT USE)
```bash
# INCORRECT: Using _runtime/ folder for agent coordination
echo "research findings" > _runtime/research-output.md
# Problem: Files deleted after 24h, other agents may not access in time
```

### ‚úÖ CORRECT APPROACH (USE THIS)
```yaml
# Agents use claude-flow MCP memory tools via behavioral coordination
# NOT command-line usage - agents make MCP tool calls internally

memory_coordination_pattern:
  tool_usage: "Agents call mcp__claude-flow__memory_usage internally"
  approach: "Behavioral coordination through MCP tool calls"
  storage: "Memory namespaces for cross-agent data exchange"
```

## üìö Reference Standards

**Global Standards**:
- `/knowledge/30.01-agent-coordination-patterns.md` - Global coordination patterns
- `/knowledge/30.02-memory-management-protocols.md` - Global memory protocols

**Project Standards**:
- `CLAUDE.md` lines 78-88 - RED phase memory patterns
- `content-creator.md` lines 285-303 - Memory coordination examples
- `hugo-expert.md` lines 318-325 - Hugo memory namespaces

## üß† Memory Coordination Architecture

### Memory Namespace Convention

All jt_site agents follow standardized memory namespace patterns:

```yaml
jt_site_memory_namespaces:
  # Content Creation Coordination
  content_research: "jt_site/content/research/{timestamp}/*"
  content_drafts: "jt_site/content/drafts/{timestamp}/*"
  content_strategy: "jt_site/content/strategy/{topic}/*"

  # Hugo Technical Coordination
  hugo_architecture: "jt_site/hugo/architecture/{timestamp}/*"
  hugo_templates: "jt_site/hugo/templates/{pattern_type}/*"
  hugo_build_status: "jt_site/hugo/build/{build_id}/*"

  # SEO Coordination
  seo_research: "jt_site/seo/research/{timestamp}/*"
  seo_optimization: "jt_site/seo/optimization/{page}/*"
  seo_performance: "jt_site/seo/performance/{metric_type}/*"

  # CSS Migration Coordination (Current Priority)
  css_analysis: "jt_site/css/analysis/{timestamp}/*"
  css_extraction_plan: "jt_site/css/extraction/{component}/*"
  css_consolidation_status: "jt_site/css/consolidation/{phase}/*"

  # Visual Testing Coordination
  visual_baseline: "jt_site/visual/baselines/{page}/*"
  visual_results: "jt_site/visual/results/{test_run}/*"
  visual_validation: "jt_site/visual/validation/{timestamp}/*"

  # Cross-Agent Quality Gates
  quality_validation: "jt_site/quality/{agent_name}/{timestamp}/*"
  anti_duplication: "jt_site/anti_duplication/{check_type}/*"
  build_protection: "jt_site/build/protection/{validation_type}/*"
```

## üõ†Ô∏è Agent Behavioral Integration

### How Agents Use Memory Coordination

**CRITICAL**: Agents coordinate through **behavioral descriptions**, NOT executable code in hooks.

### Content-Creator Memory Usage Example

From `content-creator.md` lines 285-303:

```yaml
content_creator_memory_patterns:
  # Standardized jt_site coordination patterns
  coordination: "jt_site/coordination/content_creator/{timestamp}/*"
  quality_validation: "jt_site/quality/content_validation/{timestamp}/*"
  anti_duplication: "jt_site/anti_duplication/content_files/{timestamp}/*"

  # Hugo site specific patterns
  hugo_site_content: "jt_site/hugo_site/content/{timestamp}/*"
  seo_strategy: "jt_site/hugo_site/seo_optimization/{timestamp}/*"
```

**Agent Behavior Description** (Natural Language):
```markdown
I coordinate content creation through claude-flow MCP memory tools. When I complete
research, I store findings in memory namespace: jt_site/content/research/{timestamp}.
When I create content drafts, I store them in: jt_site/content/drafts/{timestamp}.
I check for existing content patterns by retrieving from anti-duplication namespaces
before creating new files. I coordinate with hugo-expert by storing content requirements
in jt_site/hugo_site/content/{timestamp} for their retrieval.
```

### Hugo-Expert Memory Usage Example

From `hugo-expert.md` lines 318-325:

```yaml
hugo_coordination:
  technical_decisions: "jt_site/hugo/architecture/decisions/{timestamp}"
  template_patterns: "jt_site/hugo/templates/patterns/{pattern_type}"
  build_optimization: "jt_site/hugo/performance/optimizations/{optimization_id}"
  configuration_changes: "jt_site/hugo/config/changes/{config_section}"
  content_structure: "jt_site/hugo/content/structure/{content_type}"
```

**Agent Behavior Description** (Natural Language):
```markdown
I coordinate Hugo technical decisions through claude-flow MCP memory tools. When I
make architectural decisions, I store them in: jt_site/hugo/architecture/decisions/{timestamp}.
When I identify template patterns, I store them in: jt_site/hugo/templates/patterns/{pattern_type}.
I retrieve content requirements from content-creator's memory namespace to understand
Hugo integration needs. I store build status and validation results for other agents
to monitor Hugo health.
```

## üîÑ Cross-Agent Coordination Workflows

### Workflow 1: Content Creation with Hugo Integration

**Actors**: content-creator, hugo-expert, seo-specialist

**Memory Coordination Flow**:

1. **Content-Creator Research Phase**:
   - Stores research findings: `jt_site/content/research/{timestamp}/keywords.json`
   - Stores content strategy: `jt_site/content/strategy/{topic}/approach.md`

2. **Hugo-Expert Validates Requirements**:
   - Retrieves content requirements from: `jt_site/content/strategy/{topic}/*`
   - Stores Hugo template needs: `jt_site/hugo/templates/requirements/{topic}.md`
   - Stores Hugo build validation: `jt_site/hugo/build/{build_id}/status.json`

3. **SEO-Specialist Optimization**:
   - Retrieves content draft from: `jt_site/content/drafts/{timestamp}/*`
   - Stores SEO analysis: `jt_site/seo/optimization/{page}/recommendations.json`
   - Stores performance targets: `jt_site/seo/performance/{metric_type}/targets.json`

4. **Content-Creator Finalizes**:
   - Retrieves SEO recommendations from: `jt_site/seo/optimization/{page}/*`
   - Retrieves Hugo validation from: `jt_site/hugo/build/{build_id}/*`
   - Produces final content with all coordination inputs integrated

### Workflow 2: CSS Migration with Visual Validation

**Actors**: coder, hugo-expert, tester (visual guardian), reviewer

**Memory Coordination Flow**:

1. **Coder Analysis Phase**:
   - Stores CSS duplication analysis: `jt_site/css/analysis/{timestamp}/duplicates.json`
   - Stores extraction plan: `jt_site/css/extraction/{component}/plan.md`

2. **Hugo-Expert Validates Impact**:
   - Retrieves CSS extraction plan from: `jt_site/css/extraction/{component}/*`
   - Stores Hugo template impact: `jt_site/hugo/templates/css-impact/{component}.md`
   - Stores build protection rules: `jt_site/build/protection/css-changes.json`

3. **Tester (Visual Guardian) Captures Baselines**:
   - Stores visual baselines: `jt_site/visual/baselines/{page}/screenshots/`
   - Stores baseline metadata: `jt_site/visual/baselines/{page}/metadata.json`

4. **Coder Implements Changes**:
   - Retrieves visual baselines from: `jt_site/visual/baselines/{page}/*`
   - Implements CSS extraction with reference to baseline expectations
   - Stores implementation status: `jt_site/css/consolidation/{phase}/status.json`

5. **Tester Validates Visual Integrity**:
   - Retrieves baseline metadata from: `jt_site/visual/baselines/{page}/*`
   - Compares new screenshots against baselines
   - Stores validation results: `jt_site/visual/results/{test_run}/comparison.json`
   - Stores approval/rejection: `jt_site/visual/validation/{timestamp}/decision.json`

6. **Reviewer Final Approval**:
   - Retrieves all coordination data from relevant namespaces
   - Validates consensus across all agents
   - Stores final approval: `jt_site/quality/{agent_name}/{timestamp}/approval.json`

## üéØ Practical Implementation Examples

### Example 1: Content-Creator Storing Research Findings

**Agent Behavioral Description**:
```markdown
When I complete keyword research for a new blog post, I store my findings in memory
using the namespace pattern: jt_site/content/research/{timestamp}/keywords.

I store:
- Primary keywords and search volume
- Long-tail keyword opportunities
- Competitive analysis results
- Content gap identification
- Target audience insights

This allows hugo-expert to retrieve my research when determining Hugo template
requirements, and seo-specialist to access keyword targets when optimizing content.
```

### Example 2: Hugo-Expert Sharing Template Patterns

**Agent Behavioral Description**:
```markdown
When I identify a reusable Hugo template pattern during development, I store the
pattern in memory using: jt_site/hugo/templates/patterns/{pattern_type}.

I store:
- Template structure and usage
- Shortcode implementations
- Front matter requirements
- Performance characteristics
- Integration examples

This allows content-creator to retrieve template patterns when structuring new
content, and coder to reference proven patterns when implementing new features.
```

### Example 3: Tester (Visual Guardian) Baseline Management

**Agent Behavioral Description**:
```markdown
Before any CSS refactoring work begins, I capture visual baselines for all affected
pages and store them in: jt_site/visual/baselines/{page}/screenshots/.

I store:
- Screenshot images (PNG format)
- Screenshot metadata (resolution, timestamp)
- CSS selector mappings
- Critical visual elements inventory
- Tolerance thresholds (0.0 for refactoring)

After CSS changes, I retrieve baselines, compare against new screenshots, and store
validation results in: jt_site/visual/results/{test_run}/comparison.json with
detailed diff analysis for reviewer agent's final approval decision.
```

## üîç Memory Coordination Tools Reference

### MCP Memory Tool Capabilities

**From CLAUDE.md lines 78-88 (RED Phase Pattern)**:

```yaml
tdd_memory_namespaces:
  # Phase tracking (official claude-flow pattern)
  red_phase: "tdd/red-phase/{timestamp}"
  green_phase: "tdd/green-phase/{timestamp}"
  refactor_phase: "tdd/refactor-phase/{timestamp}"
```

**Agent Integration**: Agents use these patterns to coordinate TDD cycles, ensuring
all agents know current test status, implementation phase, and refactoring state.

### Memory Operations Agents Perform

**Store Operation**:
- Agent stores data in specific namespace
- Data persists across agent sessions
- Other agents can retrieve stored data
- Supports structured data (JSON, YAML, Markdown)

**Retrieve Operation**:
- Agent retrieves data from known namespace
- Accesses data stored by other agents
- Validates data freshness and relevance
- Integrates retrieved data into decision-making

**Search Operation**:
- Agent searches across namespaces for patterns
- Discovers coordination opportunities
- Identifies data relationships
- Enables cross-agent intelligence

## üìã Agent Configuration Integration Checklist

When creating or updating agent configurations to use memory coordination:

### ‚úÖ Required Elements

- [ ] Memory namespace patterns defined in agent description
- [ ] Behavioral description of memory usage (natural language)
- [ ] Cross-agent handoff protocols documented
- [ ] Memory coordination examples provided
- [ ] Integration with existing jt_site namespace conventions

### ‚ùå Forbidden Elements

- [ ] NO executable memory commands in hooks (npx claude-flow@alpha hooks only)
- [ ] NO file-based coordination via _runtime/ folder
- [ ] NO custom memory management scripts
- [ ] NO bypassing of memory namespace conventions
- [ ] NO hardcoded memory keys without namespace prefixes

## üö® Common Pitfalls & Solutions

### Pitfall 1: Using _runtime/ for Coordination

**Problem**: Agent stores research results in `_runtime/research.md` expecting other agents to read file
**Issue**: Files deleted after 24h, race condition for access, no structured coordination
**Solution**: Store in memory namespace `jt_site/content/research/{timestamp}/findings.json`

### Pitfall 2: Hardcoded Memory Keys

**Problem**: Agent uses key `"research_results"` without namespace prefix
**Issue**: Key collisions across projects, no organization, difficult discovery
**Solution**: Use full namespace: `jt_site/content/research/{timestamp}/research_results`

### Pitfall 3: Command-Line Memory Usage in Hooks

**Problem**: Hook contains `npx claude-flow@alpha hooks memory-store ...`
**Issue**: Hooks should only have echo + pre-task/post-task, not memory commands
**Solution**: Describe memory usage in behavioral description, let agent handle internally

### Pitfall 4: No Cross-Agent Handoff Protocol

**Problem**: content-creator stores research but doesn't document for hugo-expert
**Issue**: hugo-expert doesn't know what namespace to retrieve from
**Solution**: Document handoff protocol in both agent descriptions with namespace conventions

## üéì Learning from Existing Patterns

### Study These Configurations

1. **content-creator.md** (lines 285-303): Exemplary memory coordination patterns
2. **hugo-expert.md** (lines 318-325): Hugo-specific namespace organization
3. **CLAUDE.md** (lines 78-88): TDD phase coordination via memory

### Key Patterns to Adopt

- **Timestamp-based namespaces**: Enables chronological tracking and cleanup
- **Agent-name prefixes**: Clear ownership and responsibility boundaries
- **Hierarchical organization**: Logical grouping for easy discovery and management
- **Structured data storage**: JSON/YAML for machine-readable coordination data
- **Markdown documentation**: Human-readable context and rationale storage

## üìñ Related Documentation

### Global Standards (SUPREME AUTHORITY)
- `/knowledge/30.01-agent-coordination-patterns.md` - Coordination fundamentals
- `/knowledge/30.02-memory-management-protocols.md` - Memory protocols

### Project Standards (SECONDARY AUTHORITY)
- `CLAUDE.md` - Project configuration and agent behavioral requirements
- `docs/60.01-agent-guidance-reference.md` - Agent-specific guidance
- `docs/70-79-ai-intelligence/` - AI agent intelligence documentation

## üîÑ Continuous Improvement

### Feedback Integration

When agents discover new coordination patterns or namespace conventions:

1. Document pattern in agent behavioral description
2. Share pattern via memory: `jt_site/learning/patterns/{pattern_name}`
3. Update this how-to guide with new pattern examples
4. Coordinate with claude-flow-specialist for validation

### Pattern Evolution

As jt_site project evolves, memory coordination patterns should be:
- Reviewed quarterly for effectiveness
- Updated based on agent feedback and usage patterns
- Validated against global handbook standards
- Documented with examples and rationale

---

**Document Maintenance**:
- **Owner**: claude-flow-specialist (configuration expert)
- **Review Cycle**: Monthly or when coordination issues detected
- **Update Protocol**: Coordinate via claude-flow expert before modifications
