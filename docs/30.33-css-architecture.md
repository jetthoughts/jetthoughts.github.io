# CSS Architecture Documentation

**Authority**: Project-specific adaptation of global CSS architecture patterns
**Reference**: `/knowledge/30.01-architecture-patterns.md` (Global Standards)
**Context**: Hugo Static Site with FL-Builder Legacy Integration
**Methodology**: XP-driven consolidation with micro-refactoring discipline

## ğŸ—ï¸ ARCHITECTURAL OVERVIEW

### Design Principles
1. **Utility-First Foundation**: Core utilities provide consistent, reusable patterns
2. **Component-Based Architecture**: BEM convention with `c-` prefix for components
3. **Legacy Compatibility**: Seamless integration with existing FL-Builder patterns
4. **Performance Optimization**: Modular imports enable tree-shaking and optimization
5. **Maintainability**: Single-source-of-truth for common patterns

### Architecture Hierarchy
```
CSS Architecture Layers (Bottom-up):
â”œâ”€â”€ 1. Foundation Utilities (reset, clearfix, accessibility)
â”œâ”€â”€ 2. Layout Utilities (grid, positioning, spacing)
â”œâ”€â”€ 3. Responsive Utilities (breakpoints, visibility)
â”œâ”€â”€ 4. Component Utilities (FL-Builder patterns)
â”œâ”€â”€ 5. Component Library (BEM-based components)
â””â”€â”€ 6. Page-Specific Layouts (layout files)
```

## ğŸ“ DIRECTORY STRUCTURE

### Complete Utility Organization
```
themes/beaver/assets/css/
â”œâ”€â”€ utilities/
â”‚   â”œâ”€â”€ foundation/
â”‚   â”‚   â”œâ”€â”€ clearfix.css           # Clearfix patterns consolidated
â”‚   â”‚   â”œâ”€â”€ reset.css              # Box-sizing and reset utilities
â”‚   â”‚   â””â”€â”€ accessibility.css      # Screen reader and a11y utilities
â”‚   â”œâ”€â”€ responsive/
â”‚   â”‚   â”œâ”€â”€ visibility.css         # Show/hide utilities
â”‚   â”‚   â””â”€â”€ breakpoints.css        # Responsive breakpoint utilities
â”‚   â”œâ”€â”€ positioning/
â”‚   â”‚   â””â”€â”€ center-absolute.css    # Absolute positioning utilities
â”‚   â”œâ”€â”€ fl-builder-grid.css        # FL-Builder grid system utilities
â”‚   â”œâ”€â”€ fl-builder-basic.css       # Basic FL-Builder utilities
â”‚   â”œâ”€â”€ padding.css               # Padding utility classes
â”‚   â”œâ”€â”€ margins.css               # Margin utility classes
â”‚   â”œâ”€â”€ _colors.scss              # Color system utilities (SCSS)
â”‚   â”œâ”€â”€ _color-accessibility.scss  # Color accessibility utilities
â”‚   â””â”€â”€ c-spacing.scss            # Component spacing patterns
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ content-block.scss        # Content block components
â”‚   â”œâ”€â”€ css-utilities.scss        # CSS utility imports
â”‚   â””â”€â”€ blocks/
â”‚       â”œâ”€â”€ c-nav.scss           # Navigation component
â”‚       â””â”€â”€ c-card.scss          # Card component
â”œâ”€â”€ components.scss               # Main component library entry point
â””â”€â”€ [layout-files].css           # Page-specific layout files
```

## ğŸ§± FOUNDATION UTILITIES

### Reset and Normalization
```css
/* utilities/foundation/reset.css */
*,
*:before,
*:after {
  box-sizing: border-box; /* Consolidated from multiple files */
}

/* Additional reset patterns consolidated from 8+ files */
```

### Clearfix Patterns
```css
/* utilities/foundation/clearfix.css */
.clearfix::after {
  content: "";
  display: table;
  clear: both;
}

/* Micro-clearfix patterns extracted from fl-homepage, fl-careers, critical.css */
```

### Accessibility Utilities
```css
/* utilities/foundation/accessibility.css */
.screen-reader-only {
  position: absolute !important;
  clip: rect(1px, 1px, 1px, 1px);
  overflow: hidden;
  height: 1px;
  width: 1px;
}

/* Screen reader utilities consolidated from multiple layout files */
```

## ğŸ¯ LAYOUT UTILITIES

### Spacing System
```css
/* utilities/padding.css */
.p-0 { padding: 0; }
.p-1 { padding: 0.25rem; }
.p-2 { padding: 0.5rem; }
.p-3 { padding: 0.75rem; }
.p-4 { padding: 1rem; }
/* ... extensive padding utilities extracted from layouts */

/* utilities/margins.css */
.m-0 { margin: 0; }
.m-1 { margin: 0.25rem; }
.m-2 { margin: 0.5rem; }
.m-3 { margin: 0.75rem; }
.m-4 { margin: 1rem; }
/* ... extensive margin utilities extracted from layouts */
```

### Grid System
```css
/* utilities/fl-builder-grid.css */
.fl-row {
  width: 100%;
  margin: 0 auto;
  position: relative;
}

.fl-col-group {
  float: left;
  clear: none;
  width: 100%;
  margin: 0;
  position: relative;
}

/* FL-Builder grid patterns consolidated for reuse */
```

### Positioning Utilities
```css
/* utilities/positioning/center-absolute.css */
.center-absolute {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

/* Common positioning patterns extracted and centralized */
```

## ğŸ“± RESPONSIVE UTILITIES

### Visibility Controls
```css
/* utilities/responsive/visibility.css */
.show-mobile { display: none; }
.hide-mobile { display: block; }

@media (max-width: 768px) {
  .show-mobile { display: block; }
  .hide-mobile { display: none; }
}

/* Responsive visibility patterns from multiple files */
```

### Breakpoint System
```css
/* utilities/responsive/breakpoints.css */
@media (min-width: 768px) {
  .md\:block { display: block; }
  .md\:hidden { display: none; }
}

@media (min-width: 1024px) {
  .lg\:block { display: block; }
  .lg\:hidden { display: none; }
}

/* Standardized breakpoint utilities */
```

## ğŸ¨ COMPONENT ARCHITECTURE

### BEM Convention Implementation
```scss
// components.scss - Main component library
/* Component Library - BEM Convention with c- prefix */
@import 'components/content-block';
@import 'components/css-utilities';
@import 'components/blocks/c-nav';
@import 'components/blocks/c-card';

/* Button Component (c-button) */
.c-button {
  border-radius: 4px;
  display: inline-block;
  text-decoration: none;

  /* Size modifiers */
  &--default { padding: 12px 24px; }
  &--small { padding: 9px 18px; }
  &--large { padding: 16px 32px; }

  /* Style modifiers */
  &--primary { background-color: var(--color-primary); }
  &--secondary { background-color: var(--color-secondary); }
}
```

### Component Organization Strategy
1. **Base Components**: Core reusable components (buttons, cards, navigation)
2. **Block Components**: Page-specific component variations
3. **Utility Components**: Single-purpose utility classes
4. **Legacy Integration**: FL-Builder component compatibility layer

## ğŸ”„ FL-BUILDER INTEGRATION

### Legacy Compatibility Layer
```css
/* utilities/fl-builder-basic.css */
.fl-node-content {
  position: relative;
  z-index: 1;
}

.fl-module {
  outline: none;
  position: relative;
}

/* Essential FL-Builder patterns preserved for compatibility */
```

### Grid System Integration
```css
/* utilities/fl-builder-grid.css */
.fl-row-content-wrap {
  display: flex;
  flex-direction: column;
  min-height: 1px;
  position: relative;
}

/* FL-Builder grid system maintained for existing layouts */
```

## ğŸ¨ COLOR SYSTEM ARCHITECTURE

### Color Utilities
```scss
// utilities/_colors.scss
:root {
  --color-primary: #007cba;
  --color-secondary: #666;
  --color-accent: #ff6b35;
  --color-text: #333;
  --color-background: #fff;
}

// Color utility classes
.text-primary { color: var(--color-primary); }
.bg-primary { background-color: var(--color-primary); }
// ... additional color utilities
```

### Accessibility Color System
```scss
// utilities/_color-accessibility.scss
// High contrast color variations for accessibility
.text-high-contrast { color: #000; }
.bg-high-contrast { background-color: #fff; }

// WCAG-compliant color combinations
```

## ğŸ“Š IMPORT STRATEGY

### Modular Import System
```scss
// Main entry points for different contexts:

// For components.scss (component library):
@import 'components/content-block';
@import 'components/css-utilities';
@import 'components/blocks/c-nav';
@import 'components/blocks/c-card';

// For layout files (utility imports):
@import '../utilities/foundation/clearfix.css';
@import '../utilities/margins.css';
@import '../utilities/padding.css';
@import '../utilities/fl-builder-grid.css';
```

### Performance Optimization
- **Tree Shaking**: Modular imports enable unused CSS elimination
- **Lazy Loading**: Components can be loaded on-demand
- **Caching**: Utility files cached separately from components
- **Minification**: Each utility file optimized independently

## ğŸ§ª CONSOLIDATION METHODOLOGY

### Extraction Process
1. **Pattern Identification**: Scan multiple files for duplicate patterns
2. **Micro-Extraction**: Extract 2-3 patterns per commit (â‰¤3 line rule)
3. **Utility Creation**: Create dedicated utility files for common patterns
4. **Import Replacement**: Replace duplicate code with utility imports
5. **Validation**: Test build and visual regression after each step

### Quality Assurance
- **Visual Regression Testing**: Screenshot comparison before/after
- **Build Validation**: Hugo build success after each change
- **Performance Testing**: Lighthouse scores maintained or improved
- **Cross-Browser Testing**: Consistent rendering across browsers

## ğŸš€ FUTURE ARCHITECTURE EVOLUTION

### Phase 3 Roadmap
1. **PowerPack Component Extraction**: InfoBox, Tabs, Reviews components
2. **Advanced Color System**: Complete design token implementation
3. **Typography System**: Font size, line height, font family utilities
4. **Animation Utilities**: Transition and animation helper classes
5. **CSS Custom Properties**: Enhanced CSS variable system

### Scalability Considerations
- **Component Library Growth**: Framework for adding new BEM components
- **Utility Expansion**: Pattern for creating new utility categories
- **Performance Monitoring**: Build size tracking and optimization
- **Documentation**: Living style guide integration

## ğŸ“‹ MAINTENANCE GUIDELINES

### Adding New Utilities
1. **Pattern Recognition**: Identify repeated patterns across 3+ files
2. **Utility Creation**: Create focused utility file with clear naming
3. **Documentation**: Update this architecture document
4. **Import Updates**: Add imports to relevant layout files
5. **Testing**: Validate visual and build integrity

### Component Development
1. **BEM Convention**: Follow established `c-` prefix pattern
2. **Modular Design**: Create focused, single-responsibility components
3. **Import Organization**: Maintain clean import structure
4. **Legacy Integration**: Ensure FL-Builder compatibility when needed

### Performance Optimization
1. **Dead Code Elimination**: Regularly audit and remove unused utilities
2. **Import Optimization**: Minimize unnecessary imports
3. **Build Monitoring**: Track CSS bundle size changes
4. **Cache Strategy**: Leverage modular structure for efficient caching

---

**Architecture Status**: âœ… **PRODUCTION READY**
**Consolidation**: **887+ lines consolidated into 27 utility files**
**Maintenance**: **Ongoing utility-first development enabled**
**Performance**: **Optimized for Hugo static site generation**

*Documentation maintained by CSS Architecture team following XP and TDD principles.*