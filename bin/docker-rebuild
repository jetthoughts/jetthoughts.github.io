#!/usr/bin/env bash

set -euo pipefail

echo "ðŸš€ Rebuilding Docker images with optimizations..."

# Clean up old containers and images for fresh build
echo "ðŸ§¹ Cleaning up old containers and images..."
bin/dc down --volumes --remove-orphans || true
docker system prune -f || true

# Build with optimized settings
echo "ðŸ”¨ Building optimized Docker image..."
DOCKER_BUILDKIT=1 bin/dc build --no-cache --parallel t

echo "âœ… Docker rebuild complete!"
echo "ðŸ’¡ Run 'bin/dtest' to test the optimizations"